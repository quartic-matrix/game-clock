<html>
  <body>

    <input type="button" id="send-1" name="Send 1" value="Send 1" />
    <input type="button" id="send-2" name="Send 2" value="Send 2" />
    <h4 id="received"></h4>

    <script src="deploy/webrtc-swarm.js"></script> 
    <script>
      document.getElementById("send-1").addEventListener("click", send1);
      document.getElementById("send-2").addEventListener("click", send2);

      var sw = new WebRTCSwarm('swarm-example', ['https://quartic-matrix-signalhub.herokuapp.com/'])

      if (!sw.WEBRTC_SUPPORT) {

      }

      sw.on('connect', function (peer, id) {
        console.log('connected to a new peer:', id)
        console.log('total peers:', sw.peers.length)

        peer.on('error', function (err) { 
          console.log('error', err); 
        })
        
        peer.on('data', function (data) {
          document.getElementById("received").innerHTML = data;
        })
        
        peer.send('whatever' + Math.random())
      })

      sw.on('disconnect', function (peer, id) {
        console.log('disconnected from a peer:', id)
        console.log('total peers:', sw.peers.length)
      })
          
      function send1() {
        broadcast('1');
      }

      function send2() {
        broadcast('2');
      }

      function broadcast(data) {
        sw.peers.forEach(function (peer) {
          peer.send(data);
        });
      }
    </script> 
  </body>
</html>